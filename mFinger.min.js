!function(t,i){"use strict";var s=function(){function t(t,i,s){return t.addEventListener(i,s,!1)}function i(t,i,s,e){var h=t-s,o=i-e;return Math.abs(h)>=Math.abs(o)?h>0?"left":"right":o>0?"up":"down"}function s(t,i){return Math.sqrt(t*t+i*i)}function e(t,i){var e=t.x*i.y-i.x*t.y,h=s(t.x,t.y)*s(i.x,i.y);if(0===h)return 0;var o=t.x*i.x+t.y*i.y,n=o/h;return n>1&&(n=1),-1>n&&(n=-1),Math.acos(n)*(e>0?-1:1)*180/Math.PI}return{on:t,getDirection:i,getDistance:s,getRotateAngle:e}}(),e=function(t,e){this.el="string"==typeof t?i.querySelector(t):t,e=e||{},this.stop=e.stop===!1?!1:!0,this.prevent=e.prevent===!1?!1:!0,this.flick=e.flick||function(){},this.tap=e.tap||function(){},this.doubleTap=e.doubleTap||function(){},this.longTap=e.longTap||function(){},this.pressMove=e.pressMove||function(){},this.swipe=e.swipe||function(){},this.pinch=e.pinch||function(){},this.rotate=e.rotate||function(){},this.start=e.start||function(){},this.move=e.move||function(){},this.end=e.end||function(){},this._events={},this.touchVector=null,this.touchDistance=0,this.previousTouchTime=0,this.previousTouchPoint=null,this.tapTimeout=null,this.longTapTimeout=null,s.on(this.el,"touchstart",this._start.bind(this)),s.on(this.el,"touchmove",this._move.bind(this)),s.on(this.el,"touchend",this._end.bind(this)),s.on(this.el,"touchcancel",this._end.bind(this)),this._init()};e.prototype={_init:function(){this.$on("flick",this.flick),this.$on("tap",this.tap),this.$on("doubleTap",this.doubleTap),this.$on("longTap",this.longTap),this.$on("pressMove",this.pressMove),this.$on("swipe",this.swipe),this.$on("pinch",this.pinch),this.$on("rotate",this.rotate),this.$on("start",this.start),this.$on("move",this.move),this.$on("end",this.end)},_start:function(t){t.touches&&(this.stop&&t.stopPropagation(),this.prevent&&t.preventDefault(),this._clearLongTapTimeout(),this._reset(),this.startTime=Date.now(),this.startX=t.touches[0].pageX,this.startY=t.touches[0].pageY,t.touches.length>1?(this.touchVector={x:t.touches[1].pageX-this.startX,y:t.touches[1].pageY-this.startY},this.touchDistance=s.getDistance(this.touchVector.x,this.touchVector.y)):(this.longTapTimeout=setTimeout(function(){this._trigger("longTap",t)}.bind(this),750),this.previousTouchPoint&&Math.abs(this.startX-this.previousTouchPoint.startX)<10&&Math.abs(this.startY-this.previousTouchPoint.startY)<10&&this.startTime-this.previousTouchTime<250&&(this.isDoubleTap=!0),this.previousTouchTime=this.startTime,this.previousTouchPoint={startX:this.startX,startY:this.startY}),this._trigger("start",t))},_move:function(t){if(t.touches){this.stop&&t.stopPropagation(),this.prevent&&t.preventDefault(),this._clearLongTapTimeout();var i=t.touches[0].pageX,e=t.touches[0].pageY;if(t.touches.length>1){if(null!==this.touchVector){var h={x:t.touches[1].pageX-i,y:t.touches[1].pageY-e},o=s.getDistance(h.x,h.y);this.touchDistance>0&&(t.$scale=o/this.touchDistance,this._trigger("pinch",t)),t.$angle=s.getRotateAngle(h,this.touchVector),this._trigger("rotate",t),this.touchVector.x=h.x,this.touchVector.y=h.y}}else this.deltaX=null===this.moveX?0:i-this.moveX,this.deltaY=null===this.moveY?0:e-this.moveY,t.$deltaX=this.deltaX,t.$deltaY=this.deltaY,this._trigger("pressMove",t);this.moveX=i,this.moveY=e,this._trigger("move",t)}},_end:function(t){if(t.changedTouches){this.stop&&t.stopPropagation(),this.prevent&&t.preventDefault();var i=Date.now();if(this._clearLongTapTimeout(),null!==this.moveX&&Math.abs(this.moveX-this.startX)>10||null!==this.moveY&&Math.abs(this.moveY-this.startY)>10)i-this.startTime<300&&(t.$deltaX=this.deltaX,t.$deltaY=this.deltaY,t.$direction=s.getDirection(this.startX,this.startY,this.moveX,this.moveY),this._trigger("swipe",t));else{if(i-this.startTime>500)return;this._trigger("flick",t),this.isDoubleTap?(this.isDoubleTap=!1,this.tapTimeout&&clearTimeout(this.tapTimeout),this._trigger("doubleTap",t)):this.tapTimeout=setTimeout(function(){this._trigger("tap",t)}.bind(this),250)}this._trigger("end",t)}},_reset:function(){this.moveX=null,this.moveY=null,this.deltaX=0,this.deltaY=0},_clearLongTapTimeout:function(){this.longTapTimeout&&clearTimeout(this.longTapTimeout)},_trigger:function(t){if(this._events[t]){var i=0,s=this._events[t].length;if(s)for(;s>i;i++)this._events[t][i].apply(this,[].slice.call(arguments,1))}},$on:function(t,i){this._events[t]||(this._events[t]=[]),this._events[t].push(i)},$off:function(t,i){if(this._events[t]){var s=this._events[t].indexOf(i);s>-1&&this._events[t].splice(s,1)}}},"function"==typeof define&&(define.amd||define.cmd)?define("mFinger",[],function(){return e}):t.mFinger=e}(window,document);